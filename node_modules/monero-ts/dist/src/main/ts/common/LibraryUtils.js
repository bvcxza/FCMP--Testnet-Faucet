"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _assert = _interopRequireDefault(require("assert"));
var _GenUtils = _interopRequireDefault(require("./GenUtils"));
var _MoneroError = _interopRequireDefault(require("./MoneroError"));
var _ThreadPool = _interopRequireDefault(require("./ThreadPool"));
var _path = _interopRequireDefault(require("path"));

/**
 * Collection of helper utilities for the library.
 */
class LibraryUtils {

  // static variables
  static LOG_LEVEL = 0;





  static MUTEX = new _ThreadPool.default(1);
  static WORKER_DIST_PATH_DEFAULT = _GenUtils.default.isBrowser() ? "/monero.worker.js" : function () {

    // get worker path in dist (assumes library is running from src or dist)
    let curPath = _path.default.normalize(__dirname);
    const targetPath = _path.default.join('monero-ts', 'dist');
    if (!curPath.includes(targetPath)) curPath = _path.default.join(curPath, "../../../../dist/src/main/js/common");
    curPath = LibraryUtils.prefixWindowsPath(_path.default.join(curPath, "./MoneroWebWorker.js"));
    if (_GenUtils.default.isDeno()) curPath = _path.default.join("file://", curPath);
    return curPath;
  }();
  static WORKER_DIST_PATH = LibraryUtils.WORKER_DIST_PATH_DEFAULT;
  static WORKER_LOADER = undefined;

  /**
   * Log a message.
   *
   * @param {number} level - log level of the message
   * @param {string} msg - message to log
   */
  static log(level, msg) {
    (0, _assert.default)(level === parseInt(level, 10) && level >= 0, "Log level must be an integer >= 0");
    if (LibraryUtils.LOG_LEVEL >= level) console.log(msg);
  }

  /**
   * Set the library's log level with 0 being least verbose.
   *
   * @param {number} level - the library's log level
   */
  static async setLogLevel(level) {
    (0, _assert.default)(level === parseInt(level, 10) && level >= 0, "Log level must be an integer >= 0");
    LibraryUtils.LOG_LEVEL = level;
    if (LibraryUtils.WASM_MODULE) LibraryUtils.WASM_MODULE.set_log_level(level);
    if (LibraryUtils.WORKER) await LibraryUtils.invokeWorker(undefined, "setLogLevel", [level]);
  }

  /**
   * Get the library's log level.
   *
   * @return {number} the library's log level
   */
  static getLogLevel() {
    return LibraryUtils.LOG_LEVEL;
  }

  /**
   * Get the total memory used by WebAssembly.
   * 
   * @return {Promise<number>} the total memory used by WebAssembly
   */
  static async getWasmMemoryUsed() {
    let total = 0;
    if (LibraryUtils.WORKER) total += await LibraryUtils.invokeWorker(undefined, "getWasmMemoryUsed", []);
    if (LibraryUtils.getWasmModule() && LibraryUtils.getWasmModule().HEAP8) total += LibraryUtils.getWasmModule().HEAP8.length;
    return total;
  }

  /**
   * Get the WebAssembly module in the current context (nodejs, browser main thread or worker).
   */
  static getWasmModule() {
    return LibraryUtils.WASM_MODULE;
  }

  /**
   * Load the WebAssembly full module with caching.
   * 
   * The full module is a superset of the keys module and overrides it.
   */
  static async loadWasmModule() {

    // use cache if suitable, full module supersedes keys module because it is superset
    if (LibraryUtils.WASM_MODULE && LibraryUtils.FULL_LOADED) return LibraryUtils.WASM_MODULE;

    // load module
    const module = await require("#monero-ts/monero.js")();
    LibraryUtils.WASM_MODULE = module;
    delete LibraryUtils.WASM_MODULE.then;
    LibraryUtils.FULL_LOADED = true;
    LibraryUtils.initWasmModule(LibraryUtils.WASM_MODULE);
    return module;
  }

  /**
   * Register a function by id which informs if unauthorized requests (e.g.
   * self-signed certificates) should be rejected.
   * 
   * @param {string} fnId - unique identifier for the function
   * @param {function} fn - function to inform if unauthorized requests should be rejected
   */
  static setRejectUnauthorizedFn(fnId, fn) {
    if (!LibraryUtils.REJECT_UNAUTHORIZED_FNS) LibraryUtils.REJECT_UNAUTHORIZED_FNS = [];
    if (fn === undefined) delete LibraryUtils.REJECT_UNAUTHORIZED_FNS[fnId];else
    LibraryUtils.REJECT_UNAUTHORIZED_FNS[fnId] = fn;
  }

  /**
   * Indicate if unauthorized requests should be rejected.
   * 
   * @param {string} fnId - uniquely identifies the function
   */
  static isRejectUnauthorized(fnId) {
    if (!LibraryUtils.REJECT_UNAUTHORIZED_FNS[fnId]) throw new Error("No function registered with id " + fnId + " to inform if unauthorized reqs should be rejected");
    return LibraryUtils.REJECT_UNAUTHORIZED_FNS[fnId]();
  }

  /**
   * Set the path to load the worker. Defaults to "/monero.worker.js" in the browser
   * and "./MoneroWebWorker.js" in node.
   * 
   * @param {string} workerDistPath - path to load the worker
   */
  static setWorkerDistPath(workerDistPath) {
    let path = LibraryUtils.prefixWindowsPath(workerDistPath ? workerDistPath : LibraryUtils.WORKER_DIST_PATH_DEFAULT);
    if (path !== LibraryUtils.WORKER_DIST_PATH) delete LibraryUtils.WORKER;
    LibraryUtils.WORKER_DIST_PATH = path;
  }

  /**
   * Set the worker loader closure to customize worker loading.
   * Takes precedence over default loading mechanisms.
   *
   * Could be as simple as `() => new Worker(new URL("monero-ts/dist/monero.worker.js", import.meta.url));` for browsers.
   *
   * @param {function} loader - loader function which instantiates a worker
   */
  static setWorkerLoader(loader) {
    LibraryUtils.WORKER_LOADER = loader;
  }

  /**
   * Get a singleton instance of a worker to share.
   * 
   * @return {Worker} a worker to share among wallet instances
   */
  static async getWorker() {

    // one time initialization
    if (!LibraryUtils.WORKER) {

      // try to load worker with user provided closure
      if (LibraryUtils.WORKER_LOADER) {
        LibraryUtils.WORKER = LibraryUtils.WORKER_LOADER();
      } else {

        // otherwise use standard loading mechanisms for browser and node
        if (_GenUtils.default.isBrowser()) {
          LibraryUtils.WORKER = new Worker(LibraryUtils.WORKER_DIST_PATH);
        } else if (_GenUtils.default.isDeno()) {
          LibraryUtils.WORKER = new Worker(LibraryUtils.WORKER_DIST_PATH, { type: "module" });
        } else {
          const Worker = require("web-worker"); // import web worker if nodejs
          LibraryUtils.WORKER = new Worker(LibraryUtils.WORKER_DIST_PATH);
        }
      }
      LibraryUtils.WORKER_OBJECTS = {}; // store per object running in the worker

      // receive worker errors
      LibraryUtils.WORKER.onerror = function (err) {
        console.error("Error posting message to monero.worker.js; is it built and copied to the app's public or build directory?");
        console.log(err);
      };

      // receive worker messages
      LibraryUtils.WORKER.onmessage = function (e) {

        // lookup object id, callback function, and this arg
        let thisArg = undefined;
        let callbackFn = LibraryUtils.WORKER_OBJECTS[e.data[0]].callbacks[e.data[1]]; // look up by object id then by function name
        if (callbackFn === undefined) throw new Error("No worker callback function defined for key '" + e.data[1] + "'");
        if (callbackFn instanceof Array) {// this arg may be stored with callback function
          thisArg = callbackFn[1];
          callbackFn = callbackFn[0];
        }

        // invoke callback function with this arg and arguments
        callbackFn.apply(thisArg, e.data.slice(2));
      };
    }
    return LibraryUtils.WORKER;
  }

  static addWorkerCallback(objectId, callbackId, callbackArgs) {
    LibraryUtils.WORKER_OBJECTS[objectId].callbacks[callbackId] = callbackArgs;
  }

  static removeWorkerCallback(objectId, callbackId) {
    delete LibraryUtils.WORKER_OBJECTS[objectId].callbacks[callbackId];
  }

  static removeWorkerObject(objectId) {
    delete LibraryUtils.WORKER_OBJECTS[objectId];
  }

  /**
   * Terminate monero-ts's singleton worker.
   */
  static async terminateWorker() {
    if (LibraryUtils.WORKER) {
      LibraryUtils.WORKER.terminate();
      delete LibraryUtils.WORKER;
      LibraryUtils.WORKER = undefined;
    }
  }

  /**
   * Invoke a worker function and get the result with error handling.
   * 
   * @param {string} objectId identifies the worker object to invoke (default random id)
   * @param {string} fnName is the name of the function to invoke
   * @param {any[]} [args] are function arguments to invoke with
   * @return {any} resolves with response payload from the worker or an error
   */
  static async invokeWorker(objectId, fnName, args) {
    (0, _assert.default)(fnName.length >= 2);
    let worker = await LibraryUtils.getWorker();
    let randomObject = objectId === undefined;
    if (randomObject) objectId = _GenUtils.default.getUUID();
    if (!LibraryUtils.WORKER_OBJECTS[objectId]) LibraryUtils.WORKER_OBJECTS[objectId] = { callbacks: {} };
    let callbackId = _GenUtils.default.getUUID();
    try {
      return await new Promise((resolve, reject) => {
        LibraryUtils.WORKER_OBJECTS[objectId].callbacks[callbackId] = (resp) => {// TODO: this defines function once per callback
          delete LibraryUtils.WORKER_OBJECTS[objectId].callbacks[callbackId];
          if (randomObject) delete LibraryUtils.WORKER_OBJECTS[objectId];
          resp ? resp.error ? reject(new Error(JSON.stringify(resp.error))) : resolve(resp.result) : resolve(undefined);
        };
        worker.postMessage([objectId, fnName, callbackId].concat(args === undefined ? [] : _GenUtils.default.listify(args)));
      });
    } catch (e) {
      throw LibraryUtils.deserializeError(JSON.parse(e.message));
    }
  }

  static serializeError(err) {
    const serializedErr = { name: err.name, message: err.message, code: err.code, stack: err.stack };
    if (err instanceof _MoneroError.default) serializedErr.type = "MoneroError";
    return serializedErr;
  }

  static deserializeError(serializedErr) {
    const err = serializedErr.type === "MoneroError" ? new _MoneroError.default(serializedErr.message, serializedErr.code) : new Error(serializedErr.message);
    err.name = serializedErr.name;
    err.stack = err.stack + "\nWorker error: " + serializedErr.stack;
    return err;
  }

  static async queueTask(asyncFn) {
    return LibraryUtils.MUTEX.submit(asyncFn);
  }

  static async exists(fs, path) {
    try {
      await fs.access(path);
      return true;
    } catch (err) {
      return false;
    }
  }

  // ------------------------------ PRIVATE HELPERS ---------------------------

  static initWasmModule(wasmModule) {
    wasmModule.taskQueue = new _ThreadPool.default(1);
    wasmModule.queueTask = async function (asyncFn) {return wasmModule.taskQueue.submit(asyncFn);};
  }

  static prefixWindowsPath(path) {
    if (/^[A-Z]:/.test(path) && path.indexOf("file://") == -1) path = "file://" + path; // prepend e.g. C: paths with file://
    return path;
  }
}exports.default = LibraryUtils;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXNzZXJ0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfR2VuVXRpbHMiLCJfTW9uZXJvRXJyb3IiLCJfVGhyZWFkUG9vbCIsIl9wYXRoIiwiTGlicmFyeVV0aWxzIiwiTE9HX0xFVkVMIiwiTVVURVgiLCJUaHJlYWRQb29sIiwiV09SS0VSX0RJU1RfUEFUSF9ERUZBVUxUIiwiR2VuVXRpbHMiLCJpc0Jyb3dzZXIiLCJjdXJQYXRoIiwicGF0aCIsIm5vcm1hbGl6ZSIsIl9fZGlybmFtZSIsInRhcmdldFBhdGgiLCJqb2luIiwiaW5jbHVkZXMiLCJwcmVmaXhXaW5kb3dzUGF0aCIsImlzRGVubyIsIldPUktFUl9ESVNUX1BBVEgiLCJXT1JLRVJfTE9BREVSIiwidW5kZWZpbmVkIiwibG9nIiwibGV2ZWwiLCJtc2ciLCJhc3NlcnQiLCJwYXJzZUludCIsImNvbnNvbGUiLCJzZXRMb2dMZXZlbCIsIldBU01fTU9EVUxFIiwic2V0X2xvZ19sZXZlbCIsIldPUktFUiIsImludm9rZVdvcmtlciIsImdldExvZ0xldmVsIiwiZ2V0V2FzbU1lbW9yeVVzZWQiLCJ0b3RhbCIsImdldFdhc21Nb2R1bGUiLCJIRUFQOCIsImxlbmd0aCIsImxvYWRXYXNtTW9kdWxlIiwiRlVMTF9MT0FERUQiLCJtb2R1bGUiLCJ0aGVuIiwiaW5pdFdhc21Nb2R1bGUiLCJzZXRSZWplY3RVbmF1dGhvcml6ZWRGbiIsImZuSWQiLCJmbiIsIlJFSkVDVF9VTkFVVEhPUklaRURfRk5TIiwiaXNSZWplY3RVbmF1dGhvcml6ZWQiLCJFcnJvciIsInNldFdvcmtlckRpc3RQYXRoIiwid29ya2VyRGlzdFBhdGgiLCJzZXRXb3JrZXJMb2FkZXIiLCJsb2FkZXIiLCJnZXRXb3JrZXIiLCJXb3JrZXIiLCJ0eXBlIiwiV09SS0VSX09CSkVDVFMiLCJvbmVycm9yIiwiZXJyIiwiZXJyb3IiLCJvbm1lc3NhZ2UiLCJlIiwidGhpc0FyZyIsImNhbGxiYWNrRm4iLCJkYXRhIiwiY2FsbGJhY2tzIiwiQXJyYXkiLCJhcHBseSIsInNsaWNlIiwiYWRkV29ya2VyQ2FsbGJhY2siLCJvYmplY3RJZCIsImNhbGxiYWNrSWQiLCJjYWxsYmFja0FyZ3MiLCJyZW1vdmVXb3JrZXJDYWxsYmFjayIsInJlbW92ZVdvcmtlck9iamVjdCIsInRlcm1pbmF0ZVdvcmtlciIsInRlcm1pbmF0ZSIsImZuTmFtZSIsImFyZ3MiLCJ3b3JrZXIiLCJyYW5kb21PYmplY3QiLCJnZXRVVUlEIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXNwIiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc3VsdCIsInBvc3RNZXNzYWdlIiwiY29uY2F0IiwibGlzdGlmeSIsImRlc2VyaWFsaXplRXJyb3IiLCJwYXJzZSIsIm1lc3NhZ2UiLCJzZXJpYWxpemVFcnJvciIsInNlcmlhbGl6ZWRFcnIiLCJuYW1lIiwiY29kZSIsInN0YWNrIiwiTW9uZXJvRXJyb3IiLCJxdWV1ZVRhc2siLCJhc3luY0ZuIiwic3VibWl0IiwiZXhpc3RzIiwiZnMiLCJhY2Nlc3MiLCJ3YXNtTW9kdWxlIiwidGFza1F1ZXVlIiwidGVzdCIsImluZGV4T2YiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3RzL2NvbW1vbi9MaWJyYXJ5VXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFzc2VydCBmcm9tIFwiYXNzZXJ0XCI7XG5pbXBvcnQgR2VuVXRpbHMgZnJvbSBcIi4vR2VuVXRpbHNcIjtcbmltcG9ydCBNb25lcm9FcnJvciBmcm9tIFwiLi9Nb25lcm9FcnJvclwiO1xuaW1wb3J0IFRocmVhZFBvb2wgZnJvbSBcIi4vVGhyZWFkUG9vbFwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcblxuLyoqXG4gKiBDb2xsZWN0aW9uIG9mIGhlbHBlciB1dGlsaXRpZXMgZm9yIHRoZSBsaWJyYXJ5LlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMaWJyYXJ5VXRpbHMge1xuXG4gIC8vIHN0YXRpYyB2YXJpYWJsZXNcbiAgc3RhdGljIExPR19MRVZFTCA9IDA7XG4gIHN0YXRpYyBXQVNNX01PRFVMRTogYW55O1xuICBzdGF0aWMgV09SS0VSOiBhbnk7XG4gIHN0YXRpYyBXT1JLRVJfT0JKRUNUUzogYW55O1xuICBzdGF0aWMgRlVMTF9MT0FERUQ6IGFueTtcbiAgc3RhdGljIFJFSkVDVF9VTkFVVEhPUklaRURfRk5TOiBhbnk7XG4gIHN0YXRpYyByZWFkb25seSBNVVRFWCA9IG5ldyBUaHJlYWRQb29sKDEpO1xuICBzdGF0aWMgV09SS0VSX0RJU1RfUEFUSF9ERUZBVUxUID0gR2VuVXRpbHMuaXNCcm93c2VyKCkgPyBcIi9tb25lcm8ud29ya2VyLmpzXCIgOiBmdW5jdGlvbigpIHtcblxuICAgIC8vIGdldCB3b3JrZXIgcGF0aCBpbiBkaXN0IChhc3N1bWVzIGxpYnJhcnkgaXMgcnVubmluZyBmcm9tIHNyYyBvciBkaXN0KVxuICAgIGxldCBjdXJQYXRoID0gcGF0aC5ub3JtYWxpemUoX19kaXJuYW1lKTtcbiAgICBjb25zdCB0YXJnZXRQYXRoID0gcGF0aC5qb2luKCdtb25lcm8tdHMnLCAnZGlzdCcpO1xuICAgIGlmICghY3VyUGF0aC5pbmNsdWRlcyh0YXJnZXRQYXRoKSkgY3VyUGF0aCA9IHBhdGguam9pbihjdXJQYXRoLCBcIi4uLy4uLy4uLy4uL2Rpc3Qvc3JjL21haW4vanMvY29tbW9uXCIpO1xuICAgIGN1clBhdGggPSBMaWJyYXJ5VXRpbHMucHJlZml4V2luZG93c1BhdGgocGF0aC5qb2luKGN1clBhdGgsIFwiLi9Nb25lcm9XZWJXb3JrZXIuanNcIikpO1xuICAgIGlmIChHZW5VdGlscy5pc0Rlbm8oKSkgY3VyUGF0aCA9IHBhdGguam9pbihcImZpbGU6Ly9cIiwgY3VyUGF0aCk7XG4gICAgcmV0dXJuIGN1clBhdGg7XG4gIH0oKTtcbiAgc3RhdGljIFdPUktFUl9ESVNUX1BBVEggPSBMaWJyYXJ5VXRpbHMuV09SS0VSX0RJU1RfUEFUSF9ERUZBVUxUO1xuICBzdGF0aWMgV09SS0VSX0xPQURFUj86ICgpID0+IFdvcmtlciA9IHVuZGVmaW5lZDtcbiAgXG4gIC8qKlxuICAgKiBMb2cgYSBtZXNzYWdlLlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gbGV2ZWwgLSBsb2cgbGV2ZWwgb2YgdGhlIG1lc3NhZ2VcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1zZyAtIG1lc3NhZ2UgdG8gbG9nXG4gICAqL1xuICBzdGF0aWMgbG9nKGxldmVsLCBtc2cpIHtcbiAgICBhc3NlcnQobGV2ZWwgPT09IHBhcnNlSW50KGxldmVsLCAxMCkgJiYgbGV2ZWwgPj0gMCwgXCJMb2cgbGV2ZWwgbXVzdCBiZSBhbiBpbnRlZ2VyID49IDBcIik7XG4gICAgaWYgKExpYnJhcnlVdGlscy5MT0dfTEVWRUwgPj0gbGV2ZWwpIGNvbnNvbGUubG9nKG1zZyk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBTZXQgdGhlIGxpYnJhcnkncyBsb2cgbGV2ZWwgd2l0aCAwIGJlaW5nIGxlYXN0IHZlcmJvc2UuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbCAtIHRoZSBsaWJyYXJ5J3MgbG9nIGxldmVsXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgc2V0TG9nTGV2ZWwobGV2ZWwpIHtcbiAgICBhc3NlcnQobGV2ZWwgPT09IHBhcnNlSW50KGxldmVsLCAxMCkgJiYgbGV2ZWwgPj0gMCwgXCJMb2cgbGV2ZWwgbXVzdCBiZSBhbiBpbnRlZ2VyID49IDBcIik7XG4gICAgTGlicmFyeVV0aWxzLkxPR19MRVZFTCA9IGxldmVsO1xuICAgIGlmIChMaWJyYXJ5VXRpbHMuV0FTTV9NT0RVTEUpIExpYnJhcnlVdGlscy5XQVNNX01PRFVMRS5zZXRfbG9nX2xldmVsKGxldmVsKTtcbiAgICBpZiAoTGlicmFyeVV0aWxzLldPUktFUikgYXdhaXQgTGlicmFyeVV0aWxzLmludm9rZVdvcmtlcih1bmRlZmluZWQsIFwic2V0TG9nTGV2ZWxcIiwgW2xldmVsXSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgdGhlIGxpYnJhcnkncyBsb2cgbGV2ZWwuXG4gICAqXG4gICAqIEByZXR1cm4ge251bWJlcn0gdGhlIGxpYnJhcnkncyBsb2cgbGV2ZWxcbiAgICovXG4gIHN0YXRpYyBnZXRMb2dMZXZlbCgpOiBudW1iZXIge1xuICAgIHJldHVybiBMaWJyYXJ5VXRpbHMuTE9HX0xFVkVMO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHRoZSB0b3RhbCBtZW1vcnkgdXNlZCBieSBXZWJBc3NlbWJseS5cbiAgICogXG4gICAqIEByZXR1cm4ge1Byb21pc2U8bnVtYmVyPn0gdGhlIHRvdGFsIG1lbW9yeSB1c2VkIGJ5IFdlYkFzc2VtYmx5XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0V2FzbU1lbW9yeVVzZWQoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBsZXQgdG90YWwgPSAwO1xuICAgIGlmIChMaWJyYXJ5VXRpbHMuV09SS0VSKSB0b3RhbCArPSBhd2FpdCBMaWJyYXJ5VXRpbHMuaW52b2tlV29ya2VyKHVuZGVmaW5lZCwgXCJnZXRXYXNtTWVtb3J5VXNlZFwiLCBbXSkgYXMgbnVtYmVyO1xuICAgIGlmIChMaWJyYXJ5VXRpbHMuZ2V0V2FzbU1vZHVsZSgpICYmIExpYnJhcnlVdGlscy5nZXRXYXNtTW9kdWxlKCkuSEVBUDgpIHRvdGFsICs9IExpYnJhcnlVdGlscy5nZXRXYXNtTW9kdWxlKCkuSEVBUDgubGVuZ3RoO1xuICAgIHJldHVybiB0b3RhbDtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCB0aGUgV2ViQXNzZW1ibHkgbW9kdWxlIGluIHRoZSBjdXJyZW50IGNvbnRleHQgKG5vZGVqcywgYnJvd3NlciBtYWluIHRocmVhZCBvciB3b3JrZXIpLlxuICAgKi9cbiAgc3RhdGljIGdldFdhc21Nb2R1bGUoKSB7XG4gICAgcmV0dXJuIExpYnJhcnlVdGlscy5XQVNNX01PRFVMRTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIExvYWQgdGhlIFdlYkFzc2VtYmx5IGZ1bGwgbW9kdWxlIHdpdGggY2FjaGluZy5cbiAgICogXG4gICAqIFRoZSBmdWxsIG1vZHVsZSBpcyBhIHN1cGVyc2V0IG9mIHRoZSBrZXlzIG1vZHVsZSBhbmQgb3ZlcnJpZGVzIGl0LlxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGxvYWRXYXNtTW9kdWxlKCkge1xuICAgIFxuICAgIC8vIHVzZSBjYWNoZSBpZiBzdWl0YWJsZSwgZnVsbCBtb2R1bGUgc3VwZXJzZWRlcyBrZXlzIG1vZHVsZSBiZWNhdXNlIGl0IGlzIHN1cGVyc2V0XG4gICAgaWYgKExpYnJhcnlVdGlscy5XQVNNX01PRFVMRSAmJiBMaWJyYXJ5VXRpbHMuRlVMTF9MT0FERUQpIHJldHVybiBMaWJyYXJ5VXRpbHMuV0FTTV9NT0RVTEU7XG4gICAgXG4gICAgLy8gbG9hZCBtb2R1bGVcbiAgICBjb25zdCBtb2R1bGUgPSBhd2FpdCByZXF1aXJlKFwiI21vbmVyby10cy9tb25lcm8uanNcIikoKTtcbiAgICBMaWJyYXJ5VXRpbHMuV0FTTV9NT0RVTEUgPSBtb2R1bGU7XG4gICAgZGVsZXRlIExpYnJhcnlVdGlscy5XQVNNX01PRFVMRS50aGVuO1xuICAgIExpYnJhcnlVdGlscy5GVUxMX0xPQURFRCA9IHRydWU7XG4gICAgTGlicmFyeVV0aWxzLmluaXRXYXNtTW9kdWxlKExpYnJhcnlVdGlscy5XQVNNX01PRFVMRSk7XG4gICAgcmV0dXJuIG1vZHVsZTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGEgZnVuY3Rpb24gYnkgaWQgd2hpY2ggaW5mb3JtcyBpZiB1bmF1dGhvcml6ZWQgcmVxdWVzdHMgKGUuZy5cbiAgICogc2VsZi1zaWduZWQgY2VydGlmaWNhdGVzKSBzaG91bGQgYmUgcmVqZWN0ZWQuXG4gICAqIFxuICAgKiBAcGFyYW0ge3N0cmluZ30gZm5JZCAtIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgZnVuY3Rpb25cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gZm4gLSBmdW5jdGlvbiB0byBpbmZvcm0gaWYgdW5hdXRob3JpemVkIHJlcXVlc3RzIHNob3VsZCBiZSByZWplY3RlZFxuICAgKi9cbiAgc3RhdGljIHNldFJlamVjdFVuYXV0aG9yaXplZEZuKGZuSWQsIGZuKSB7XG4gICAgaWYgKCFMaWJyYXJ5VXRpbHMuUkVKRUNUX1VOQVVUSE9SSVpFRF9GTlMpIExpYnJhcnlVdGlscy5SRUpFQ1RfVU5BVVRIT1JJWkVEX0ZOUyA9IFtdO1xuICAgIGlmIChmbiA9PT0gdW5kZWZpbmVkKSBkZWxldGUgTGlicmFyeVV0aWxzLlJFSkVDVF9VTkFVVEhPUklaRURfRk5TW2ZuSWRdO1xuICAgIGVsc2UgTGlicmFyeVV0aWxzLlJFSkVDVF9VTkFVVEhPUklaRURfRk5TW2ZuSWRdID0gZm47XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBJbmRpY2F0ZSBpZiB1bmF1dGhvcml6ZWQgcmVxdWVzdHMgc2hvdWxkIGJlIHJlamVjdGVkLlxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZuSWQgLSB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBmdW5jdGlvblxuICAgKi9cbiAgc3RhdGljIGlzUmVqZWN0VW5hdXRob3JpemVkKGZuSWQpIHtcbiAgICBpZiAoIUxpYnJhcnlVdGlscy5SRUpFQ1RfVU5BVVRIT1JJWkVEX0ZOU1tmbklkXSkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZnVuY3Rpb24gcmVnaXN0ZXJlZCB3aXRoIGlkIFwiICsgZm5JZCArIFwiIHRvIGluZm9ybSBpZiB1bmF1dGhvcml6ZWQgcmVxcyBzaG91bGQgYmUgcmVqZWN0ZWRcIik7XG4gICAgcmV0dXJuIExpYnJhcnlVdGlscy5SRUpFQ1RfVU5BVVRIT1JJWkVEX0ZOU1tmbklkXSgpO1xuICB9XG4gIFxuICAvKipcbiAgICogU2V0IHRoZSBwYXRoIHRvIGxvYWQgdGhlIHdvcmtlci4gRGVmYXVsdHMgdG8gXCIvbW9uZXJvLndvcmtlci5qc1wiIGluIHRoZSBicm93c2VyXG4gICAqIGFuZCBcIi4vTW9uZXJvV2ViV29ya2VyLmpzXCIgaW4gbm9kZS5cbiAgICogXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB3b3JrZXJEaXN0UGF0aCAtIHBhdGggdG8gbG9hZCB0aGUgd29ya2VyXG4gICAqL1xuICBzdGF0aWMgc2V0V29ya2VyRGlzdFBhdGgod29ya2VyRGlzdFBhdGgpIHtcbiAgICBsZXQgcGF0aCA9IExpYnJhcnlVdGlscy5wcmVmaXhXaW5kb3dzUGF0aCh3b3JrZXJEaXN0UGF0aCA/IHdvcmtlckRpc3RQYXRoIDogTGlicmFyeVV0aWxzLldPUktFUl9ESVNUX1BBVEhfREVGQVVMVCk7XG4gICAgaWYgKHBhdGggIT09IExpYnJhcnlVdGlscy5XT1JLRVJfRElTVF9QQVRIKSBkZWxldGUgTGlicmFyeVV0aWxzLldPUktFUjtcbiAgICBMaWJyYXJ5VXRpbHMuV09SS0VSX0RJU1RfUEFUSCA9IHBhdGg7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSB3b3JrZXIgbG9hZGVyIGNsb3N1cmUgdG8gY3VzdG9taXplIHdvcmtlciBsb2FkaW5nLlxuICAgKiBUYWtlcyBwcmVjZWRlbmNlIG92ZXIgZGVmYXVsdCBsb2FkaW5nIG1lY2hhbmlzbXMuXG4gICAqXG4gICAqIENvdWxkIGJlIGFzIHNpbXBsZSBhcyBgKCkgPT4gbmV3IFdvcmtlcihuZXcgVVJMKFwibW9uZXJvLXRzL2Rpc3QvbW9uZXJvLndvcmtlci5qc1wiLCBpbXBvcnQubWV0YS51cmwpKTtgIGZvciBicm93c2Vycy5cbiAgICpcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gbG9hZGVyIC0gbG9hZGVyIGZ1bmN0aW9uIHdoaWNoIGluc3RhbnRpYXRlcyBhIHdvcmtlclxuICAgKi9cbiAgc3RhdGljIHNldFdvcmtlckxvYWRlcihsb2FkZXI/OiAoKSA9PiBXb3JrZXIpOiB2b2lkIHtcbiAgICBMaWJyYXJ5VXRpbHMuV09SS0VSX0xPQURFUiA9IGxvYWRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzaW5nbGV0b24gaW5zdGFuY2Ugb2YgYSB3b3JrZXIgdG8gc2hhcmUuXG4gICAqIFxuICAgKiBAcmV0dXJuIHtXb3JrZXJ9IGEgd29ya2VyIHRvIHNoYXJlIGFtb25nIHdhbGxldCBpbnN0YW5jZXNcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRXb3JrZXIoKSB7XG4gICAgXG4gICAgLy8gb25lIHRpbWUgaW5pdGlhbGl6YXRpb25cbiAgICBpZiAoIUxpYnJhcnlVdGlscy5XT1JLRVIpIHtcblxuICAgICAgLy8gdHJ5IHRvIGxvYWQgd29ya2VyIHdpdGggdXNlciBwcm92aWRlZCBjbG9zdXJlXG4gICAgICBpZiAoTGlicmFyeVV0aWxzLldPUktFUl9MT0FERVIpIHtcbiAgICAgICAgTGlicmFyeVV0aWxzLldPUktFUiA9IExpYnJhcnlVdGlscy5XT1JLRVJfTE9BREVSKCk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIC8vIG90aGVyd2lzZSB1c2Ugc3RhbmRhcmQgbG9hZGluZyBtZWNoYW5pc21zIGZvciBicm93c2VyIGFuZCBub2RlXG4gICAgICAgIGlmIChHZW5VdGlscy5pc0Jyb3dzZXIoKSkge1xuICAgICAgICAgIExpYnJhcnlVdGlscy5XT1JLRVIgPSBuZXcgV29ya2VyKExpYnJhcnlVdGlscy5XT1JLRVJfRElTVF9QQVRIKTtcbiAgICAgICAgfSBlbHNlIGlmIChHZW5VdGlscy5pc0Rlbm8oKSkge1xuICAgICAgICAgIExpYnJhcnlVdGlscy5XT1JLRVIgPSBuZXcgV29ya2VyKExpYnJhcnlVdGlscy5XT1JLRVJfRElTVF9QQVRILCB7IHR5cGU6IFwibW9kdWxlXCIgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgV29ya2VyID0gcmVxdWlyZShcIndlYi13b3JrZXJcIik7IC8vIGltcG9ydCB3ZWIgd29ya2VyIGlmIG5vZGVqc1xuICAgICAgICAgIExpYnJhcnlVdGlscy5XT1JLRVIgPSBuZXcgV29ya2VyKExpYnJhcnlVdGlscy5XT1JLRVJfRElTVF9QQVRIKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgTGlicmFyeVV0aWxzLldPUktFUl9PQkpFQ1RTID0ge307ICAvLyBzdG9yZSBwZXIgb2JqZWN0IHJ1bm5pbmcgaW4gdGhlIHdvcmtlclxuICAgICAgXG4gICAgICAvLyByZWNlaXZlIHdvcmtlciBlcnJvcnNcbiAgICAgIExpYnJhcnlVdGlscy5XT1JLRVIub25lcnJvciA9IGZ1bmN0aW9uKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcG9zdGluZyBtZXNzYWdlIHRvIG1vbmVyby53b3JrZXIuanM7IGlzIGl0IGJ1aWx0IGFuZCBjb3BpZWQgdG8gdGhlIGFwcCdzIHB1YmxpYyBvciBidWlsZCBkaXJlY3Rvcnk/XCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gcmVjZWl2ZSB3b3JrZXIgbWVzc2FnZXNcbiAgICAgIExpYnJhcnlVdGlscy5XT1JLRVIub25tZXNzYWdlID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBcbiAgICAgICAgLy8gbG9va3VwIG9iamVjdCBpZCwgY2FsbGJhY2sgZnVuY3Rpb24sIGFuZCB0aGlzIGFyZ1xuICAgICAgICBsZXQgdGhpc0FyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IGNhbGxiYWNrRm4gPSBMaWJyYXJ5VXRpbHMuV09SS0VSX09CSkVDVFNbZS5kYXRhWzBdXS5jYWxsYmFja3NbZS5kYXRhWzFdXTsgLy8gbG9vayB1cCBieSBvYmplY3QgaWQgdGhlbiBieSBmdW5jdGlvbiBuYW1lXG4gICAgICAgIGlmIChjYWxsYmFja0ZuID09PSB1bmRlZmluZWQpIHRocm93IG5ldyBFcnJvcihcIk5vIHdvcmtlciBjYWxsYmFjayBmdW5jdGlvbiBkZWZpbmVkIGZvciBrZXkgJ1wiICsgZS5kYXRhWzFdICsgXCInXCIpO1xuICAgICAgICBpZiAoY2FsbGJhY2tGbiBpbnN0YW5jZW9mIEFycmF5KSB7ICAvLyB0aGlzIGFyZyBtYXkgYmUgc3RvcmVkIHdpdGggY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgICAgICB0aGlzQXJnID0gY2FsbGJhY2tGblsxXTtcbiAgICAgICAgICBjYWxsYmFja0ZuID0gY2FsbGJhY2tGblswXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gaW52b2tlIGNhbGxiYWNrIGZ1bmN0aW9uIHdpdGggdGhpcyBhcmcgYW5kIGFyZ3VtZW50c1xuICAgICAgICBjYWxsYmFja0ZuLmFwcGx5KHRoaXNBcmcsIGUuZGF0YS5zbGljZSgyKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBMaWJyYXJ5VXRpbHMuV09SS0VSO1xuICB9XG5cbiAgc3RhdGljIGFkZFdvcmtlckNhbGxiYWNrKG9iamVjdElkLCBjYWxsYmFja0lkLCBjYWxsYmFja0FyZ3MpIHtcbiAgICBMaWJyYXJ5VXRpbHMuV09SS0VSX09CSkVDVFNbb2JqZWN0SWRdLmNhbGxiYWNrc1tjYWxsYmFja0lkXSA9IGNhbGxiYWNrQXJncztcbiAgfVxuXG4gIHN0YXRpYyByZW1vdmVXb3JrZXJDYWxsYmFjayhvYmplY3RJZCwgY2FsbGJhY2tJZCkge1xuICAgIGRlbGV0ZSBMaWJyYXJ5VXRpbHMuV09SS0VSX09CSkVDVFNbb2JqZWN0SWRdLmNhbGxiYWNrc1tjYWxsYmFja0lkXTtcbiAgfVxuXG4gIHN0YXRpYyByZW1vdmVXb3JrZXJPYmplY3Qob2JqZWN0SWQpIHtcbiAgICBkZWxldGUgTGlicmFyeVV0aWxzLldPUktFUl9PQkpFQ1RTW29iamVjdElkXTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFRlcm1pbmF0ZSBtb25lcm8tdHMncyBzaW5nbGV0b24gd29ya2VyLlxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHRlcm1pbmF0ZVdvcmtlcigpIHtcbiAgICBpZiAoTGlicmFyeVV0aWxzLldPUktFUikge1xuICAgICAgTGlicmFyeVV0aWxzLldPUktFUi50ZXJtaW5hdGUoKTtcbiAgICAgIGRlbGV0ZSBMaWJyYXJ5VXRpbHMuV09SS0VSO1xuICAgICAgTGlicmFyeVV0aWxzLldPUktFUiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW52b2tlIGEgd29ya2VyIGZ1bmN0aW9uIGFuZCBnZXQgdGhlIHJlc3VsdCB3aXRoIGVycm9yIGhhbmRsaW5nLlxuICAgKiBcbiAgICogQHBhcmFtIHtzdHJpbmd9IG9iamVjdElkIGlkZW50aWZpZXMgdGhlIHdvcmtlciBvYmplY3QgdG8gaW52b2tlIChkZWZhdWx0IHJhbmRvbSBpZClcbiAgICogQHBhcmFtIHtzdHJpbmd9IGZuTmFtZSBpcyB0aGUgbmFtZSBvZiB0aGUgZnVuY3Rpb24gdG8gaW52b2tlXG4gICAqIEBwYXJhbSB7YW55W119IFthcmdzXSBhcmUgZnVuY3Rpb24gYXJndW1lbnRzIHRvIGludm9rZSB3aXRoXG4gICAqIEByZXR1cm4ge2FueX0gcmVzb2x2ZXMgd2l0aCByZXNwb25zZSBwYXlsb2FkIGZyb20gdGhlIHdvcmtlciBvciBhbiBlcnJvclxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGludm9rZVdvcmtlcihvYmplY3RJZCwgZm5OYW1lLCBhcmdzKSB7XG4gICAgYXNzZXJ0KGZuTmFtZS5sZW5ndGggPj0gMik7XG4gICAgbGV0IHdvcmtlciA9IGF3YWl0IExpYnJhcnlVdGlscy5nZXRXb3JrZXIoKTtcbiAgICBsZXQgcmFuZG9tT2JqZWN0ID0gb2JqZWN0SWQgPT09IHVuZGVmaW5lZDtcbiAgICBpZiAocmFuZG9tT2JqZWN0KSBvYmplY3RJZCA9IEdlblV0aWxzLmdldFVVSUQoKTtcbiAgICBpZiAoIUxpYnJhcnlVdGlscy5XT1JLRVJfT0JKRUNUU1tvYmplY3RJZF0pIExpYnJhcnlVdGlscy5XT1JLRVJfT0JKRUNUU1tvYmplY3RJZF0gPSB7Y2FsbGJhY2tzOiB7fX07XG4gICAgbGV0IGNhbGxiYWNrSWQgPSBHZW5VdGlscy5nZXRVVUlEKCk7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIExpYnJhcnlVdGlscy5XT1JLRVJfT0JKRUNUU1tvYmplY3RJZF0uY2FsbGJhY2tzW2NhbGxiYWNrSWRdID0gKHJlc3ApID0+IHsgIC8vIFRPRE86IHRoaXMgZGVmaW5lcyBmdW5jdGlvbiBvbmNlIHBlciBjYWxsYmFja1xuICAgICAgICAgIGRlbGV0ZSBMaWJyYXJ5VXRpbHMuV09SS0VSX09CSkVDVFNbb2JqZWN0SWRdLmNhbGxiYWNrc1tjYWxsYmFja0lkXTtcbiAgICAgICAgICBpZiAocmFuZG9tT2JqZWN0KSBkZWxldGUgTGlicmFyeVV0aWxzLldPUktFUl9PQkpFQ1RTW29iamVjdElkXTtcbiAgICAgICAgICByZXNwID8gKHJlc3AuZXJyb3IgPyByZWplY3QobmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KHJlc3AuZXJyb3IpKSkgOiByZXNvbHZlKHJlc3AucmVzdWx0KSkgOiByZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZShbb2JqZWN0SWQsIGZuTmFtZSwgY2FsbGJhY2tJZF0uY29uY2F0KGFyZ3MgPT09IHVuZGVmaW5lZCA/IFtdIDogR2VuVXRpbHMubGlzdGlmeShhcmdzKSkpO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICB0aHJvdyBMaWJyYXJ5VXRpbHMuZGVzZXJpYWxpemVFcnJvcihKU09OLnBhcnNlKGUubWVzc2FnZSkpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBzZXJpYWxpemVFcnJvcihlcnIpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkRXJyOiBhbnkgPSB7IG5hbWU6IGVyci5uYW1lLCBtZXNzYWdlOiBlcnIubWVzc2FnZSwgY29kZTogZXJyLmNvZGUsIHN0YWNrOiBlcnIuc3RhY2sgfTtcbiAgICBpZiAoZXJyIGluc3RhbmNlb2YgTW9uZXJvRXJyb3IpIHNlcmlhbGl6ZWRFcnIudHlwZSA9IFwiTW9uZXJvRXJyb3JcIjtcbiAgICByZXR1cm4gc2VyaWFsaXplZEVycjtcbiAgfVxuXG4gIHByb3RlY3RlZCBzdGF0aWMgZGVzZXJpYWxpemVFcnJvcihzZXJpYWxpemVkRXJyKSB7XG4gICAgY29uc3QgZXJyID0gc2VyaWFsaXplZEVyci50eXBlID09PSBcIk1vbmVyb0Vycm9yXCIgPyBuZXcgTW9uZXJvRXJyb3Ioc2VyaWFsaXplZEVyci5tZXNzYWdlLCBzZXJpYWxpemVkRXJyLmNvZGUpIDogbmV3IEVycm9yKHNlcmlhbGl6ZWRFcnIubWVzc2FnZSk7XG4gICAgZXJyLm5hbWUgPSBzZXJpYWxpemVkRXJyLm5hbWU7XG4gICAgZXJyLnN0YWNrID0gZXJyLnN0YWNrICsgXCJcXG5Xb3JrZXIgZXJyb3I6IFwiICsgc2VyaWFsaXplZEVyci5zdGFjaztcbiAgICByZXR1cm4gZXJyO1xuICB9XG5cbiAgc3RhdGljIGFzeW5jIHF1ZXVlVGFzazxUPihhc3luY0ZuOiAoKSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIExpYnJhcnlVdGlscy5NVVRFWC5zdWJtaXQoYXN5bmNGbik7XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgZXhpc3RzKGZzOiBhbnksIHBhdGg6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmcy5hY2Nlc3MocGF0aCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQUklWQVRFIEhFTFBFUlMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIFxuICBwcm90ZWN0ZWQgc3RhdGljIGluaXRXYXNtTW9kdWxlKHdhc21Nb2R1bGUpIHtcbiAgICB3YXNtTW9kdWxlLnRhc2tRdWV1ZSA9IG5ldyBUaHJlYWRQb29sKDEpO1xuICAgIHdhc21Nb2R1bGUucXVldWVUYXNrID0gYXN5bmMgZnVuY3Rpb24oYXN5bmNGbikgeyByZXR1cm4gd2FzbU1vZHVsZS50YXNrUXVldWUuc3VibWl0KGFzeW5jRm4pOyB9XG4gIH1cbiAgXG4gIHByb3RlY3RlZCBzdGF0aWMgcHJlZml4V2luZG93c1BhdGgocGF0aCkge1xuICAgIGlmICgvXltBLVpdOi8udGVzdChwYXRoKSAmJiBwYXRoLmluZGV4T2YoXCJmaWxlOi8vXCIpID09IC0xKSBwYXRoID0gXCJmaWxlOi8vXCIgKyBwYXRoOyAvLyBwcmVwZW5kIGUuZy4gQzogcGF0aHMgd2l0aCBmaWxlOi8vXG4gICAgcmV0dXJuIHBhdGg7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6InlMQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFlBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLFdBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDZSxNQUFNSyxZQUFZLENBQUM7O0VBRWhDO0VBQ0EsT0FBT0MsU0FBUyxHQUFHLENBQUM7Ozs7OztFQU1wQixPQUFnQkMsS0FBSyxHQUFHLElBQUlDLG1CQUFVLENBQUMsQ0FBQyxDQUFDO0VBQ3pDLE9BQU9DLHdCQUF3QixHQUFHQyxpQkFBUSxDQUFDQyxTQUFTLENBQUMsQ0FBQyxHQUFHLG1CQUFtQixHQUFHLFlBQVc7O0lBRXhGO0lBQ0EsSUFBSUMsT0FBTyxHQUFHQyxhQUFJLENBQUNDLFNBQVMsQ0FBQ0MsU0FBUyxDQUFDO0lBQ3ZDLE1BQU1DLFVBQVUsR0FBR0gsYUFBSSxDQUFDSSxJQUFJLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQztJQUNqRCxJQUFJLENBQUNMLE9BQU8sQ0FBQ00sUUFBUSxDQUFDRixVQUFVLENBQUMsRUFBRUosT0FBTyxHQUFHQyxhQUFJLENBQUNJLElBQUksQ0FBQ0wsT0FBTyxFQUFFLHFDQUFxQyxDQUFDO0lBQ3RHQSxPQUFPLEdBQUdQLFlBQVksQ0FBQ2MsaUJBQWlCLENBQUNOLGFBQUksQ0FBQ0ksSUFBSSxDQUFDTCxPQUFPLEVBQUUsc0JBQXNCLENBQUMsQ0FBQztJQUNwRixJQUFJRixpQkFB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